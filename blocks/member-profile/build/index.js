(window.webpackJsonp_wawp_addon_member_directory=window.webpackJsonp_wawp_addon_member_directory||[]).push([[1],{6:function(e,t,r){}}]),function(e){function t(t){for(var s,n,l=t[0],o=t[1],c=t[2],u=0,p=[];u<l.length;u++)n=l[u],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&p.push(i[n][0]),i[n]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);for(d&&d(t);p.length;)p.shift()();return a.push.apply(a,c||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],s=!0,l=1;l<r.length;l++){var o=r[l];0!==i[o]&&(s=!1)}s&&(a.splice(t--,1),e=n(n.s=r[0]))}return e}var s={},i={0:0},a=[];function n(t){if(s[t])return s[t].exports;var r=s[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=s,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var l=window.webpackJsonp_wawp_addon_member_directory=window.webpackJsonp_wawp_addon_member_directory||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=o;a.push([7,1]),r()}([function(e,t){e.exports=window.wp.element},function(e,t){e.exports=window.wp.components},function(e,t){e.exports=window.wp.blockEditor},function(e,t){e.exports=window.wp.i18n},function(e,t){e.exports=window.wp.blocks},function(e,t){e.exports=window.React},,function(e,t,r){"use strict";r.r(t),r.d(t,"renderHiddenFields",(function(){return h})),r.d(t,"generateShortcode",(function(){return y}));var s=r(0),i=r(4),a=(r(6),r(3),r(2)),n=r(1);class l extends React.Component{constructor(e){super(e),this.state={attributes:e.attributes,setAttributes:e.setAttributes,field:e.field,profile:e.profile}}render(){return Object(s.createElement)(n.PanelRow,null,Object(s.createElement)(o,{field:this.state.field,attributes:this.state.attributes,setAttributes:this.state.setAttributes,profile:this.state.profile,key:this.state.field.name}))}}function o(e){let t=[];t=e.profile?e.attributes.profile_fields:e.attributes.fields_applied;let r=-1!=c(t,e.field);const[i,a]=Object(s.useState)(r);return Object(s.useEffect)(()=>{let r=c(t,e.field);i&&-1==r?t.push(e.field):i||-1==r||t.splice(r,1),e.profile?e.setAttributes({profile_fields:t}):e.setAttributes({fields_applied:t})}),Object(s.createElement)(n.CheckboxControl,{label:e.field.name,checked:i,onChange:a})}function c(e,t){for(var r=0;r<e.length;r++)if(e[r].id==t.id)return r;return-1}var d=new class{constructor(){this.init()}init(){null==this.data&&(this.data=[],this.system=[],this.member=[],this.common=[]),0==this.data.length&&this.populateFieldData()}async populateFieldData(){(await(async()=>{const e=await fetch("/wp-json/wawp/v1/contacts/fields/",{headers:{"Content-Type":"application/json",Accept:"application/json"}}),t=await e.text();return JSON.parse(t)})()).forEach(e=>{let t="";e.IsSystem?(t="system",this.system.push({id:e.SystemCode,name:e.FieldName})):e.MemberOnly?(t="member",this.member.push({id:e.SystemCode,name:e.FieldName})):(t="common",this.common.push({id:e.SystemCode,name:e.FieldName})),this.data[e.SystemCode]={name:e.FieldName,type:e.Type,allowed_values:e.AllowedValues,access:e.Access,category:t,support_search:e.SupportSearch,order:e.Order,system_code:e.SystemCode}})}async getFieldName(e){return null==this.data[e]&&this.populateFieldData().then(()=>this.data[e].name),this.data[e].name}getSystemFields(){return this.system}getCommonFields(){return this.common}getMemberFields(){return this.member}getData(){return this.data}isMultiple(e){return"MultipleChoice"==this.data[e].type}};class u{constructor(){this.data=[],this.populateSavedSearches()}populateSavedSearches(){(async()=>{const e=await fetch("/wp-json/wawp/v1/savedsearches/",{headers:{"Content-Type":"application/json",Accept:"application/json"}}),t=await e.text();return JSON.parse(t)})().then(e=>{this.data=e})}getSearchOptions(){var e=[];return e.push(u.getNullSearchOption()),this.data.forEach(t=>{e.push({label:t.Name,value:t.Id})}),e}getFirstSearchOption(){var e=this.data[0];return{label:e.Name,value:e.Id}}static getNullSearchOption(){return{value:0,label:"Select a saved search"}}}new u;var p=r(5);r.n(p).a.Component,React.Component;class b extends React.Component{constructor(e){super(e),this.state={system:d.getSystemFields(),common:d.getCommonFields(),member:d.getMemberFields(),attributes:e.attributes,setAttributes:e.setAttributes},console.log(this.state.system)}render(){return Object(s.createElement)(n.Panel,null,Object(s.createElement)(n.PanelBody,{title:"System Fields",initialOpen:!1},this.state.system.map(e=>Object(s.createElement)(l,{attributes:this.state.attributes,setAttributes:this.state.setAttributes,field:e,profile:!1}))),Object(s.createElement)(n.PanelBody,{title:"Common Fields",initialOpen:!1},this.state.common.map(e=>Object(s.createElement)(l,{attributes:this.state.attributes,setAttributes:this.state.setAttributes,field:e,profile:!1}))),Object(s.createElement)(n.PanelBody,{title:"Member Fields",initialOpen:!1},this.state.member.map(e=>Object(s.createElement)(l,{attributes:this.state.attributes,setAttributes:this.state.setAttributes,field:e,profile:!1}))),Object(s.createElement)(m,{attributes:this.state.attributes,setAttributes:this.state.setAttributes}),Object(s.createElement)(f,{attributes:this.state.attributes,setAttributes:this.state.setAttributes}))}}function m(e){let t=e.attributes,r=e.setAttributes;const[i,a]=Object(s.useState)(t.user_id);return Object(s.useEffect)(()=>{r({user_id:i})}),Object(s.createElement)(n.PanelBody,{title:"User"},Object(s.createElement)(n.__experimentalInputControl,{value:i,onChange:e=>a(e),label:"User ID"}))}function f(e){const[t,r]=Object(s.useState)(e.attributes.hide_restricted_fields);return Object(s.useEffect)(()=>{e.setAttributes({hide_restricted_fields:t})}),Object(s.createElement)(n.PanelBody,{title:"Hide Restricted Fields",initialOpen:!0},Object(s.createElement)(n.PanelRow,null,Object(s.createElement)(n.ToggleControl,{label:"Hide restricted fields",checked:t,onChange:r})))}function h(e){return Object(s.createElement)("div",{className:"hidden"},Object(s.createElement)("ul",null,e.fields_applied.map(e=>Object(s.createElement)("li",{className:"filter",key:e.id,"data-system-code":e.id,"data-name":e.name},e.name))),Object(s.createElement)("div",{id:"user_id","data-user-id":e.user_id}),Object(s.createElement)("div",{id:"hide_restricted_fields","data-hide-restricted-fields":e.hide_restricted_fields},e.hide_restricted_fields))}function y(e){var t="[wa-profile ",r=e.fields_applied.length;for(let s=0;s<r;s++)t+="'"+e.fields_applied[s].name+"'",t+=" ";return t+=" user-id="+e.user_id,e.hide_restricted_fields&&(t+=" hide_restricted_fields"),t+="]",Object(s.createElement)("p",null,t)}Object(i.registerBlockType)("wawp-member-addons/member-profile",{attributes:{fields_applied:{type:"array",default:[],source:"query",selector:"li.filter",query:{id:{type:"string",source:"attribute",attribute:"data-system-code"},name:{type:"string",source:"attribute",attribute:"data-name"}}},user_id:{type:"string",default:"",selector:"#user_id",attribute:"data-user-id"},hide_restricted_fields:{type:"boolean",default:!0,selector:"#hide_restricted_fields",attribute:"data-hide-restricted-fields"}},edit:function({attributes:e,setAttributes:t}){return Object(s.createElement)("div",Object(a.useBlockProps)(),Object(s.createElement)(a.InspectorControls,{key:"setting"},Object(s.createElement)(b,{attributes:e,setAttributes:t})),Object(s.createElement)("div",a.useBlockProps.save(),h(e),y(e)))},save:function({attributes:e}){return Object(s.createElement)("div",a.useBlockProps.save(),h(e),y(e))}})}]);